#**Lab 9: Using Templates**

Running all these individual commands can be tedious and error prone.
Fortunately for you, all of this configuration can be put together into a
Template which can then be processed to create a full set of resources. A
Template may define parameters for certain values, such as DB username or
password, and they can be automatically generated by OpenShift at processing
time.

Administrators can load Templates into OpenShift and make them available to
all users, even via the web console. Users can create Templates and load them
into their own Projects for other users (with access) to share and use.

The great thing about templates is they can speed up the deployment workflow for
application development by providing a "recipe" of sorts that can be used with a
single command.  Not only that, they can be loaded into OpenShift with a URL,
which will allow you to keep your templates in a version control system.

Let's combine all of the exercises we have performed in the last three labs into
a Template that we can then instantiate with a single command.  I bet you are
probably hating us now for having you go through all of that work when you could
have issued a single command! Just remember that it is important for you to
understand how to create, deploy, and wire resources together.  In order for the
magic to happen, first create a new project and add the template to the project:

	$ oc new-project CITYNAMEuserXX-template
	$ oc create -f https://raw.githubusercontent.com/sabre1041/ose-rht-offices/master/rhtoffices-template.json

Now we have access to the application template in our project.  As a side note, administrators have the capability to add templates to the general *openshift* project which will in turn provide an application template to any user on the system.

Are you ready for the magic command?  Here it is:

	$ oc new-app rhtoffices

You will see the following output:

    --> Deploying template rhtoffices for "rhtoffices"
        With parameters:
        APPLICATION_NAME=rhtoffices
        APPLICATION_HOSTNAME=
        GIT_URI=https://github.com/sabre1041/ose-rht-offices.git
        GIT_REF=master
        MONGODB_DATABASE=root
        IMAGE_STREAM_NAMESPACE=openshift
        DATABASE_SERVICE_NAME=mongodb
       MONGODB_USER=user5UJ # generated
       MONGODB_PASSWORD=IePONrj5 # generated
       MONGODB_ADMIN_PASSWORD=ttpkf2EG # generated
       GITHUB_TRIGGER_SECRET=oGiNRHaH # generated
       GENERIC_TRIGGER_SECRET=fCRbCdCW # generated
    --> Creating resources with label app=rhtoffices ...
        BuildConfig "rhtoffices" created
        ImageStream "rhtoffices" created
        DeploymentConfig "mongodb" created
        DeploymentConfig "rhtoffices" created
        Route "rhtoffices-http-route" created
        Service "mongodb" created
        Service "rhtoffices-http" created
        Service "rhtoffices-ping" created
    --> Success
        Build scheduled for "rhtoffices" - use the logs command to track its progress.
        Run 'oc status' to view your app.


One other nifty thing that happened is that a route was created for you automatically as well.  Check it out:

	$ oc get routes

	NAME                    HOST/PORT                                                                                  PATH      SERVICE           LABELS                                                               INSECURE POLICY   TLS TERMINATION
    rhtoffices-http-route   rhtoffices-http-route-oseuser-template.apps.CITYNAME-roadshow.rhc-ose.labs.redhat.com             rhtoffices-http   app=rhtoffices,application=rhtoffices,template=rhtoffices-template

OpenShift will automatically start a build for you. When it is complete, visit
your app. Does it work? Think about how this could be used in your environment.
For example, a template could define a large set of resources that make up a
"reference application", complete with several app servers, databases, and more.
You could deploy the entire set of resources with one command, and then hack on
them to develop new features, microservices, fix bugs, and more.

As a final exercise, look at the template that was used to create the
resources for our *rhtoffices* application.

    https://raw.githubusercontent.com/sabre1041/ose-rht-offices/master/rhtoffices-template.json

**End of Lab 9**